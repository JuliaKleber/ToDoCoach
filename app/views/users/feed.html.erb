<div class='d-flex flex-row justify-content-between'>

  <div class="d-flex">
    <div class='card' style='background-color: #242474; color: white'>Following</div>
      <%= link_to achievements_user_path, class: 'card' do %>
      Achievements
      <% end %>
  </div>

  <%= link_to connect_user_path(current_user), class: 'card' do %>
    <i class="fa-solid fa-user-plus"></i>
  <% end %>
  <%= link_to disconnect_user_path(current_user), class: 'card' do %>
    <i class="fa-solid fa-user-slash"></i>
  <% end %>
</div>

<div class="notifications mt-3">
  <% @invitations.each do |invitation| %>
    <div class='card'>
      <div class='d-flex flex-row'>
        <% if invitation.task.user.photo.attached? %>
          <%= cl_image_tag invitation.task.user.photo.key, class: "avatar" %>
        <% else %>
          <p><% image_tag "alf.jpg", class: "avatar" %>
        <% end %>
        <h4> <%= invitation.task.title %> </h4>
      </div>

      <%= link_to add_user_task_path(invitation.task) do %>
      <div class="d-flex justify-content-center">
        <button class='btn btn-reject'>Accept</button>
      <% end %>
      <%= link_to task_invitation_path(invitation), data: { turbo_method: :delete } do %>
        <button class='btn btn-reject'>Reject</button>
      <% end %>
      </div>
    </div>
  <% end %>
</div>

<div class="notifications">
  <% @followed.each do |followed| %>
    <% followed.user_achievement_congratulations.each do |congratulation| %>
      <% if Time.now.to_date - congratulation.date < 7 %>
        <div class='card my-3'>
          <%# <p class="text-center"> <%= followed.user_name %> <%# earned a new badge: </p> %>
          <div class='d-flex flex-row'>
            <% if followed.photo.attached? %>
              <%= cl_image_tag followed.photo.key, class: "avatar" %>
            <% else %>
              <p><%= image_tag "alf.jpg", class: "avatar" %>
            <% end %>
            <p class="mb-0 pb-0"><%= "#{followed.user_name} congratulated you on achieving" %></p>
            <h4><%= congratulation.achievement.name %>ðŸŽ‰</h4>
          </div>
          <button class='btn btn-primary congrats mt-3'>Send congratulations!</button>
        </div>
        <%= link_to congratulate_path do %>
          <button class='btn btn-primary con grats mt-3'>Send congratulations!</button>
        <% end %>
      </div>
      <% end %>
    <% end %>
  <% end %>
</div>

<div class="notifications">
  <% @followed.each do |followed| %>
    <% followed.achievements.each do |achievement| %>
      <% if Time.now.to_date - achievement.user_achievements.find_by(user_id: followed.id).date < 7 %>
        <div class='card my-3'>

          <div class='d-flex flex-row justify-content-between'>
            <% if followed.photo.attached? %>
              <%= cl_image_tag followed.photo.key, class: "avatar" %>
            <% else %>
              <p><%= image_tag "alf.jpg", class: "avatar" %>
            <% end %>
            <div class="d-flex flex-column">
              <p class="mb-0 pb-0"><%= "#{followed.user_name} earned a new badge:" %></p>
              <h4><%= achievement.name %>ðŸŽ‰</h4>
            </div>
            <% if followed.photo.attached? %>
              <%= cl_image_tag followed.photo.key, class: "avatar" %>
            <% else %>
              <p><% image_tag "alf.jpg", class: "avatar" %>
            <% end %>
          </div>

          <button class='btn btn-primary congrats mt-3'>Send congratulations!</button>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>
