
<div class='card task-card d-flex flex-row'>
  <div class='m-3 d-flex align-items-center'>
    <% if @tasks_category_names[index].include?("Work") %>
      <i class="fa-solid fa-briefcase"></i>
    <% elsif @tasks_category_names[index].include?("Groceries") %>
      <i class="fa-solid fa-basket-shopping"></i>
    <% elsif @tasks_category_names[index].include?("Personal") %>
      <i class="fa-solid fa-user"></i>
    <% else %>
      <i class="fa-solid fa-ghost"></i>
    <% end %>
  </div>

  <div class='task-info'>
    <div data-controller="edit-task">
      <div class='d-flex flex-row'>
        <div class='m-3'>

          <p data-edit-task-target="info">
            <%= link_to task_path(task) do %>
              <%= task.title %>
            <% end %>
          </p>

          <% if task.due_date != nil %>
            <p>
              <% if task.due_date.hour < 12 %>
                <%= task.due_date.strftime("%H:%M") %>
                am
              <% else %>
                <%= (task.due_date - (12*60*60)).strftime("%H:%M") %>
                pm
              <% end %>
            </p>
          <% end %>
        </div>

        <div class='m-3'>
          <p><%= render 'priority_dot', task: task %></p>
          <p><%= render 'toggle_completed', task: task %></p>
        </div>

      </div>

      <p style='margin-left: 16px'>
        <% if task.description.split('').length > 30 %>
          <%= task.description.split.first(4).join(' ') %> ...
        <% else %>
          <%= task.description %>
        <% end %>
      </p>
    </div>

    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">Update <%= task.title %></h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">
            <%= simple_form_for task do |f| %>
              <%= f.input :title %>
              <%= f.input :description %>
              <%= f.input :due_date, as: :datetime, html5: true %>
              <%= f.submit "Save changes", class:"btn btn-primary rounded" %>
            <% end %>
          </div>

        </div>
      </div>
    </div>
  </div>

  <i class="fa-solid fa-pen"
      style="color: #242474;"
      data-action="click->edit-task#displayForm"
      data-bs-toggle="modal"
      data-bs-target="#staticBackdrop">
  </i>

</div>
